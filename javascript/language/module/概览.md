# 概览

JavaScript的主要运行环境是浏览器，且原本不支持`模块`，后续在ES6中添加了模块功能。

本文将大致梳理一下JavaScript现有的模块系统。
# ES6之前的模块实现

在标准化之前，存在多种第三方模块实现方案，特别是Node.js的模块方案目前还在被广泛使用。

# ES6模块

## HTML中的模块

浏览器中的JavaScript代码都是在HTML页面中声明的，现在可以声明为模块：

```html
<!--可以是内嵌代码，或者外部文件-->
<script type="module"></script>
```

这**区别于传统的JavaScript代码执行模式**。传统情况下浏览器在解析HTML时遇到JavaScript脚本会**同步**下载、解析、运行，而JavaScript模块会异步下载、解析，并在解析完HTML文档后按照先后顺序依次执行。

`async`会**进一步改变JavaScript模块执行模式**，在异步加载、解析JavaScript模块的基础上，异步执行JavaScript模块。

## Node.js中的模块

Node.js环境也支持ES6模块标准：

- 一个模块项目对外界而言是一个模块（编译结果是一个模块）
- 项目中每个独立的`.js`文件是项目的子模块

## 导入、导出、重导出

`导出`：声明本模块的公开接口信息

`导入`：声明本模块使用到的外部模块的信息

`重导出`：将其它模块的公开的接口信息作为本模块的公开接口信息进行声明

### 导出

JavaScript只有两种`访问权限`（类似`Go`）：

- 公开，可以被外部模块使用
- 非公开，只能在模块内部使用

默认访问权限是`非公开`，通过关键字`export`将标志导出为公开才能被外部模块使用。

```javascript
export function doSomething() {
}
```

> JavaScript目前使用术语`命名导出`来称呼普通导出功能，这区别于`默认导出`。

### 默认导出

```js
export default expression;
```

`默认导出`是对HTML中传统JavaScript模式的归纳：库由一个脚本文件组成，为了避免污染全局域，每个脚本文件只提供一个全局库对象

### 导入

导入的基本语句如下：

```javascript
import cube from './my-module.js';
```

重点包括：

- `标志`：导入到本模块中使用的名称，可以使用`别名`
- `源模块`：一般使用`文件路径`；使用包管理器管理的项目，支持使用`模块名称`

### 重导出

示例：

```javascript
export cube from './my-module.js';
```

# 总结

JavaScript模块系统与其它语言存在一些区别：

- 使用`export`语句作为访问权限控制
- 支持`default`导出

# 参考资料

《JavaScript高级程序设计》v4 20. 模块
