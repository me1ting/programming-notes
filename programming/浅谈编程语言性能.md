# 浅谈编程语言性能

编程语言的执行效率应该根据其执行方式进行区分：

- 机器码执行
- 解释执行

对于带有JIT的编程语言，在JIT预热后，其性能大致接近 C/C++/Rust 这样的传统编译型语言。

对于机器码执行，垃圾回收、边界检查等是性能扣分项，但只影响运行时间复杂度的常数部分。

## 案例1：JIT加持的JS执行效率与Rust持平

个人有一个使用 TypeScript 编写的HTTP API程序，其功能是将JSON数据中的字段进行本地处理（从英文翻译成中文）然后再生成XML数据。

由于对 JS 的执行效率存在怀疑，以及对于 JS 的内存占用不太满意（100M~200M），个人使用了 Rust 进行重写，使用了`serde`库用于 JSON 反序列化，使用基于`tokio`的`warp`提供 HTTP 服务，实际测试两个版本：

| 语言    | 样本 | 响应时间平均数(ms) | 响应时间中位数(ms) | 90%响应时间(ms) | 95%响应时间(ms) | 内存占用(M) |
| ------- | ---- | ------------------ | ------------------ | --------------- | --------------- | ----------- |
| Node.js | 1000 | 100                | 100                | 124             | 140             | 110         |
| Rust    | 2000 | 100                | 100                | 124             | 136             | 20          |

可以看到，两个版本从执行效率来讲没什么区别，Rust 版本的唯一优势在于内存占用。此外，个人还测试了 Bun （基于`JavaScriptCore`而非`V8`）的表现，其与Node.js的性能几乎一致。
