# 让人困惑的模块路径,包名,文件夹名

Go模块中存在许多名字，命名方式比较灵活，因此容易让人困惑，本文将进行有效梳理。

## 模块路径

```go
module golang.org/x/tools/gopls
```

[模块路径](https://go.dev/ref/mod#module-path)是模块的`规范名称`(canonical name)，在`go.mod`中定义的。

其包括了：

 - 查找位置（直接查找位置（repo地址）、间接查找位置（基于go-get协议））
 - 主版本后缀（当且仅当MAJOR版本大于1时）

一个直接查找位置包括：存储库根路径、模块在存储库中的相对路径（一般为空，不为空的示例可以看`路径层次`）

模块路径主要有两种命名风格：

- URL，如`github.com/rs/zerolog`
- 简单名称，如`mylogger`

### URL模块路径

#### 带版本控制后缀的URL模块路径

后缀包括`.bzr`, `.fossil`, `.git`, `.hg`, `.svn`

**这种情况很罕见，因为比较繁琐**。go工具链能够直接请求这些存储库。

#### 普通URL模块路径

1) **go-get协议**

普通路径主要有以下几类：

- 代码仓库的根地址，如`github.com/rs/zerolog`
- 第三方站点，如`gopkg.in/yaml`
- 自定义站点，如 `go.uber.org/zap`

这些路径都支持`go-get`协议：go工具链通过添加`go-get=1`查询参数访问其完整的https地址，站点应当在返回的html文档中添加如下的元数据：

```html
<meta name="go-import" content="root-path vcs repo-url">
```

go工具链因此得到了版本控制系统名称以及仓库地址，然后下载源码。

### 路径层次

大多数URL都避免过多的路径层次，比如`github`仓库的根地址只包括`owner`和`reponame`。

但也存在复杂的路径层次：

```
github.com/antlr/antlr4/runtime/Go/antlr
```

*这是一个位于monorepo内的模块，其相对存储库的路径不为空*，为`runtime/Go/antlr`。

### 简单名称

简单名称用于不需要导出的模块，比如构建可执行文件的模块，或是内部模块。

*这里的导出指repo级别，不包括workspace级别*

## 包名

在Go中，包是指一个目录下的所有子文件中的代码组成的实体。

`包名`应当是合法的变量名，不同于变量名称，包名应当全小写。

**包名本身不分层次，也不与其所在文件夹的名称绑定**。

但是除了`main`包和模块根目录包，与其所在文件夹不同名的包无法被使用，因此**实际上包名必须与其所在文件夹同名**。**包在import时是区分层次的**。

```go
// a/b/c/version.go;
package c

function Version()string{
	return "1.0.0"
}
```

调用代码：

```go
import(
   fmt
   "github.com/username/reponame/a/b/c"//import时需要使用包的“规范名称”
)

package main

func main(){
	fmt.Println(c.Version)//使用时只需要使用包名
}
```

## 文件夹名

正如前面所讲：

- `模块路径`可能包括文件路径
- 除了`main`包和模块根目录包，`包名`需要`文件夹名称`同名

## 参考资料

[doc: go mod](https://go.dev/ref/mod)