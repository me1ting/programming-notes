# 变量

## 空安全

`空错误`(null error)是在支持`null`并且允许null作为任意类型变量（或仅限对象类型与引用类型）的值的语言中，常常出现的问题。

在null上执行的大部分操作会产生错误，而大部分代码不会考虑值为null的情况，如果程序不经意间将null引入正常的代码逻辑，就会导致程序出错。

手动检查null虽然可以解决问题，但是耗费精力且很容易出错的，且不优雅。从语言设计上避免这个问题更好：默认情况下不允许null作为合法值，必须显式指定null。

简而言之，**空安全的语言，将“默认允许null”转变为“显式强制使用null”，避免了人为的错误引入null，也避免了人工检查**。
## 默认值

`可空类型`的默认值为`null`，`非空类型`必须初始化才能被使用。

局部变量可以声明而非立即初始化，只需要后续进行初始化。

## `late`变量

`late`使得其修饰的变量可以延迟初始化，以满足：

- 优化性能
- 语法需求：dart区分初始化过程和构造体，无法在构造体中初始化字段，而`late`使得可以这样做

## final与const

`final`表示运行时不可变量（类似js的`const`,java的`final`），`const`表示编译时常量。

### const值

`const`修饰值（字面值）时，表示值在编译时生成：

```dart
var foo = const [];
final bar = const [];
const baz = []; // 等价于`const []`
```

`const常量`所指向的`const值`可以省略后者的`const`。

*我只在C++和Rust这样系统编程语言中看到过类似区分`const值`与`const常量`的情况（主要是为了性能），但dart这样设计是否有必要？*

## 参考资料

[doc: variable](https://dart.dev/language/variables)