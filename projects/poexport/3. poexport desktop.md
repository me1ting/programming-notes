# desktop

本项目我编写了桌面客户端(electron)、chrome扩展、tampermonkey脚本三种客户端，看似满足了不同场景的需求，但实际情况不太满意。

## Electron客户端

Electron对于这样一个小型工具类项目来说，太重了。编译后的可执行文件接近100M，如果花精力裁剪和压缩，能减少到70M左右，但还是太重了。

此外，除非花精力优化，否则Electron项目的启动速度很慢，运行起来很卡。

同时JS/TS不太适合编写桌面端应用的底层，因为Node.js的相关API不太顺手。

## chrome扩展存在的问题

1) **兼容性问题**

chrome为了自己的商业利益，推出了`extension v3`，目前edege和firefox已经进行了跟进，但问题是大多数国产chrome内核的浏览器还在使用`extension v2`版本。

2) **使用难度问题**

安装chrome插件需要进入扩展设置，打开开发人员模式，然后加载。不同的浏览器UI界面不同。这对大多数用户来说，使用难度较大。

3) **更新问题**

使用开发人员模式安装的插件难以更新，包括更新检测和更新安装两个功能都难以实现。

我在编写扩展时考虑到了问题3，因此原本就不打算能更新扩展，但确实没考虑到问题1和问题2。
## tampermonkey脚本的问题

编写tampermonkey脚本是为了解决chrome扩展的问题1，但实际上扩展的问题2，问题3在脚本上依然存在，只是没那么严重：

- 使用难度问题，用户需要安装tampermonkey扩展然后安装脚本，对于大多数用户来说比较困难的
- 更新问题，tampermonkey的更新检测功能不是那么可靠和迅速，存在未检查，延迟检查的情况

## 重写客户端

基于以上问题，重写客户端势在必行。
### tauri

最开始，我尝试了tauri，甚至写好了基础的UI，但由于自己当时对于许多技术细节（UI，功能由前端js实现还是后端rust实现）没想好，因此中途搁置了。

后续，我将wails版本使用tauri重写，依然报毒（但相对好一点，主流桌面杀软都没有报毒），主要缺点是相比wails有更长的启动白屏时间(1s以上)。

### wails

直到游戏S24新赛季上线一周后，我才重拾起重写客户端的兴趣，花了周末1天多的时间用wails重写了桌面客户端。

这次重写成功得益于微软出品的react flutter ui库，让我不再困惑于UI细节，我花的主要时间也是在学习react和react router上面。

wails后端使用的是Go，比tauri使用的Rust难度降低了许多，使得我不需要花费时间在后端语言的语法细节上。

我对于wails版本基本满意，但是存在一个严重性的问题：报毒，唯一解决办法是使用收费证书进行签名，这对于个人的免费开源项目是不可行的。
### flutter

最开始，我也尝试过flutter，写好了基础的UI。同样，自己当时对于许多技术细节也没想好（主要是UI），因此存在犹豫。

另一方面，flutter在我旧系统上（LTSB2016）存在输入法BUG，让我对其兼容性产生了怀疑。

由于tauri,wails都存在致命的缺陷，因此我最后还是选择使用flutter重写了客户端。
