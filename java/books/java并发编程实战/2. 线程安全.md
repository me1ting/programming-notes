# 线程安全

## 深入理解线程安全

### 正确性

`正确性`：我们将程序在单线程下执行的结果，称为程序的正确性。这样我们可以使用正确性来描述线程安全。

`线程安全`是一个描述术语，用于描述类型、库、程序。指目标在多线程下使用时，程序能够保证正确性。

### 线程安全类型的复合操作

一般情况下，**线程安全的类型只能保证单次使用接口是原子操作**：

```java
// 假设TreadSafeHashMap是我们定义的线程安全的类型
// contains()和set()方法是线程安全的
// 但是以下操作不是线程安全的
var map = TreadSafeHashMap<String,int>();
if (!map.contains("Zhangsan")){
	map.set("Zhangsan",1000);
}
```

通常类型会为类似的操作提供原子接口，但不能覆盖人们的所有操作。

因此我们需要知道：**线程安全类型的复合操作并非线程安全**。

