# Lambda表达式

## 函数式编程

`函数式编程`是一种编程范式，其本身是一个复杂的概念，在学术界影响较大，完整的学习`函数式编程`需要具备相应的学术知识储备，以及学习一门函数式风格语言。

工业级编程语言对于函数式编程的支持，实质上是一种“鸭子方式”的支持，在语法表层上支持函数式编程语言的某些特性。
## Lambda表达式

`Lambda表达式`是函数式编程中最重要的语法之一，表示匿名函数，Java8不完整的引入了这一概念。

它的基本形式为：

```
(int x,double y) -> {
    return x+y
}
```

这种形式在大部分语言中都是差不多的。此外Java还支持几种变种，包括：

如果类型可推导，省略参数类型：

```
(x,y) -> {
    return x+y;
}
```

如果类型可推导，且只有一个参数，省略参数类型且括号：

```
x -> {
    return x;
}
```

如果代码块只有返回表达式：

```
(x,y) -> x+y
```

**对于这些变种，不属于语法的核心知识，只需要有个印象并通过IDE提示和编码练习来进行熟练**

## 函数式接口

虽然引入了Lambda表达式，但需要相应的函数类型来作为对象的类型和函数参数的类型。

Java没有引入`函数类型`，而是要求使用一种特殊的接口：它们的特点是**只有一个抽象方法的接口**，称为`函数式接口`。

>特例，接口可能会重新声明Object类的方法，为了关联javadoc的注释。

这样的约定只能依赖于编译器检查和IDE提示，Java并没引入语法层面的约束。Java提供了一个可选的注解`@FunctionalInterface`来供开发者明确的表明其定义的接口是函数式接口。

## 方法引用&构造器引用

在完整支持函数式编程的语言中，方法名等同于一个函数值，可以直接引用。而Java不支持这样做，而是使用`方法引用`，`构造器引用`这样的语法形式，来引用它们。

`方法引用`有几种语法形式，主要是因为Java中区分：

- 对象 :: 实例方法
- 类 :: 静态方法
- 类 :: 实例方法，第一个参数为目标对象

对象可以是`this`,`super`,`{OuterClass}.this`,`{OuterClass}.super`。

`构造器引用`引用的是类的构造器方法：

- 类 :: new

数组的构造器引用形式：`int[]::new`。

## 默认方法&接口中的静态方法

Java8为了支持函数式需要对一些接口引入新的方法，因此提出了`默认方法`语法，使得接口也允许存在实现方法，从而兼容旧代码。

接口现在支持`静态方法`，这并没有破坏兼容性，为提供工具方法提供了另一种选择。

*传统使用工具类封装工具方法*

## 捕获的变量

Lambda表达式可以捕获外部作用域的变量。

Java规定，lambda可以捕获闭合作用域中任何有效的final局部变量。

### 闭包

返回函数的函数（或方法）如果返回值捕获了该函数中定义的局部变量，这些局部变量并不会随该函数的退出而销毁，这些局部变量被称为`自由变量`，这样的返回值称为`闭包`。

闭包打破了传统的函数运行模型，函数就像拥有了状态一般，这种语法特性可以用来实现一些有趣的功能。

## 变量作用域

对大多数语言而言，lambda表达式中的this关键字，为创建该lambda表达式的方法的this参数。

不同的是，Java额外规定，**lambda表达式的方法体与嵌套的代码块具有相同的作用域**，因此不允许在lambda表达式中声明与局部变量同名的参数或局部变量。
