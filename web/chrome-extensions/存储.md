# 概览

目前接触过：

- `local storage` web存储标准
- `chrome storage` chrome为扩展提供的一套存储API

# local storage

*没有实际用过，因此这里的认知可能存在错误。*

`local storage`是一个web标准，它存在`域`（有待更准确的术语替代）的概念，一个`域`由`协议+域名+端口`组成（有待确认），同一个域共享一个数据库。

这套标准在扩展上使用时会存在一些问题，我们可以认为一个扩展拥有一个`域`，选项页面、界面元素、后台脚本共享该域，但是`内容脚本`是在目标页面上执行的，它并不能通过该API访问到扩展的数据库。必须使用`消息机制`，由内容脚本给后台脚本发送消息，后台脚本响应请求，完成操作然后返回给内容脚本。

因此，Chrome后续提供了`chrome storage`以简化存储操作。

# chrome storage

`chrome storage`是chrome专为扩展开发的一套存储API，优点包括：

- 扩展内共用一个数据库
- 支持所有`组成部分`无缝访问，包括内容脚本
- 支持账号同步

个人在使用过程中发现该API也存在一些缺点：

- 查询返回的是一个object对象，而不是`map`，目标值以属性的方式返回，这要求**key必须是合法的属性名**。

# 参考

chrome storage API https://developer.chrome.com/docs/extensions/reference/storage/

如何在内容脚本中使用localstorage https://stackoverflow.com/questions/3937000/chrome-extension-accessing-localstorage-in-content-script

> 提供了localstorage和chromestorage的示例代码，其中对消息机制的`method`,`key`的设计具有一定的参考意义

实际应用1 https://github.com/me1ting/poe-cn-export-extension-vue

> 自己的项目（自然是最熟悉的），用到了chrome storage，仓库内搜索：`chrome.storage.local`

