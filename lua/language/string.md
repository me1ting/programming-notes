# string

lua中的字符串具有以下特征：

- 面向ASCII（基本与C/C++相同）
- 不可变

直到lua5.3才添加了支持UTF-8的库。

## 面向ACSII

lua的字符串是面向ASCII的，有过C/C++使用体验的都会明白，这是历史原因造成的。

从实现模型来讲，我们可以将字符串当作**不可修改的字节数组**，而lua仅提供了有限的支持。


## 操作符

长度操作符`#`获取字符串的长度（字节长度）。

连接操作符`..`连接字符串，返回新的字符串。

## 字面量

符号`'`,`"`都可以用于包含字符串字面量。

转义字符串支持：

- ASCII转义字符，包括：C风格的符号转义、C风格的8进制转义、C风格的16进制转义
- UTF-8转义字符，从lua5.3开始支持

支持长字符串，使用`[[`,`]]`符号，细节查阅参考阅读。

## 转换

字符串和数字支持自动转换和手动转换。

自动转换发生在：

- 将数字转换为字符串：使用字符串连接符号
- 将字符串转换为数字：使用算数运算符

## 标准库

标准库与其他语言字符串标准库大同小异，唯一需要注意的是核心方法`string.gsub`，这是用的最多的。

`string.gsub`的基本功能是全局替代字符串中的匹配内容，支持正则、自定义替代函数等等。

## Unicode的支持

lua5.3正式支持UTF-8，但只能说是和C/C++一样的在表层上简单做了一下兼容：

- 前面提到的**UTF-8转义字符**
- utf8库

这种支持相比语言层面彻底支持UTF-8的python,golang,rust等语言来说，很多细节依然需要使用者去考虑编码的问题。

正如书中所说，操作系统库、I/O库中的文本编码都依赖于底层系统的实现，lua并没有进行任何处理。

## 参考资料

《Programming in Lua 4》chapter4.Strings

